% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/helpers.R
\name{run_only_for}
\alias{run_only_for}
\title{Restrict Execution of an R Script to Allowed SLURM Job Conditions}
\usage{
run_only_for(id = NULL, run_on_windows = TRUE, allowed_jobnames = NULL)
}
\arguments{
\item{id}{Integer or \code{NULL}. Expected SLURM array index, or \code{NULL} to skip
checking (useful for Windows/local runs).}

\item{run_on_windows}{Logical. When \code{TRUE} (default), do not restrict when
running on Windows.}

\item{allowed_jobnames}{Character vector of SLURM job names allowed to run
this script. If \code{NULL}, job-name filtering is skipped.}
}
\value{
Invisibly returns \code{NULL} when allowed; otherwise exits R.
}
\description{
\code{run_only_for()} controls when an R script is allowed to run based on:
\itemize{
\item the SLURM array index (\code{SLURM_ARRAY_TASK_ID})
\item the SLURM job name (\code{SLURM_JOB_NAME})
\item whether the script is being run locally on Windows
}

The function is designed for workflows where multiple R scripts run in a
single SLURM array job; each script decides independently whether it should
run.
}
\details{
Execution logic:
\enumerate{
\item \strong{Windows override}
If running on Windows and \code{run_on_windows = TRUE}, return immediately.
\item \strong{Allowed job names}
If \code{allowed_jobnames} is set, the script runs only when SLURM job name is
in that vector.
\item \strong{Array ID restriction}
\itemize{
\item If \code{id = NULL}, skip array-index filtering.
\item If numeric, match against \code{SLURM_ARRAY_TASK_ID}.
}
}

Any violation â†’ \code{quit(save = "no")}.
}
