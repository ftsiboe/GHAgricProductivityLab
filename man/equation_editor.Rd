% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stochastic_frontier-core.R
\name{equation_editor}
\alias{equation_editor}
\title{Build production, inefficiency, and risk equations for SFA/MSF}
\usage{
equation_editor(
  data,
  FXN,
  outcome,
  slope_shifter = "NONE",
  intercept_shifters = NULL,
  ulist = NULL,
  vlist = NULL
)
}
\arguments{
\item{data}{Data.frame or similar object containing all variables referenced
in \code{FXN}, \code{outcome}, \code{slope_shifter},
\code{intercept_shifters}, \code{ulist}, and \code{vlist}.}

\item{FXN}{Functional form of the production function. Typically a named
object where \code{FXN[[1]]} is a character string representing the
production frontier in terms of input variables (e.g.,
\code{"lnI1 + lnI2 + I(1/2 * lnI1^2) + lnI1:lnI2"} for a translog).}

\item{outcome}{Character scalar giving the dependent variable name for the
production equation (e.g., \code{"Y"} or \code{"lnY"}).}

\item{slope_shifter}{Character scalar naming a variable used as a slope
shifter in the production function. If equal to \code{"NONE"} (default),
no slope shifter is applied. Otherwise, the production equation is
specified as an interaction between \code{factor(slope_shifter)} and
\code{FXN[[1]]}, net of the baseline \code{FXN[[1]]}.}

\item{intercept_shifters}{Optional list of intercept shifters for the
production function with elements:
\itemize{
\item \code{Svarlist}: character vector of continuous shifter variables.
\item \code{Fvarlist}: character vector of categorical shifter variables
(included as \code{factor()} terms).
}
If \code{intercept_shifters} is \code{NULL} or both components are
\code{NULL}, the production function only uses \code{FXN[[1]]}.}

\item{ulist}{Optional list of covariates for the inefficiency (\eqn{u})
equation with elements:
\itemize{
\item \code{Svarlist}: character vector of continuous covariates.
\item \code{Fvarlist}: character vector of categorical covariates
(included as \code{factor()} terms).
}
If \code{ulist} is \code{NULL} or both components are \code{NULL},
the inefficiency equation is set to \code{NULL}.}

\item{vlist}{Optional list of covariates for the production risk (\eqn{v})
equation with elements:
\itemize{
\item \code{Svarlist}: character vector of continuous covariates.
\item \code{Fvarlist}: character vector of categorical covariates
(included as \code{factor()} terms).
}
If \code{vlist} is \code{NULL} or both components are \code{NULL},
the risk equation is set to \code{NULL}.}
}
\value{
A list with three components:
\itemize{
\item \code{prodfxn}: a \code{\link[stats]{formula}} for the production
frontier.
\item \code{uequ}: a \code{formula} for the inefficiency equation, or
\code{NULL} if no inefficiency covariates were retained.
\item \code{vequ}: a \code{formula} for the production risk equation, or
\code{NULL} if no risk covariates were retained.
}
}
\description{
Constructs formula objects for the production function, the inefficiency
function, and the production risk function used in stochastic frontier and
meta-stochastic frontier estimations. The function takes a generic
functional form (\code{FXN}) and conditionally augments it with intercept
and slope shifters, as well as covariates for the inefficiency (\eqn{u})
and noise (\eqn{v}) equations.
}
\details{
Continuous covariates are only included when their coefficient of variation
exceeds a small threshold (|CV| > 0.001), and categorical covariates are
included only if they have more than one level and each level has at least
a minimal share of the sample (>\code{0.01\%} of observations). This helps
avoid numerical issues from nearly-constant or extremely sparse regressors.

The function builds three formula objects:
\describe{
\item{Production function (\code{prodfxn})}{
Starts from \code{outcome ~ FXN[[1]]}. If intercept shifters are
supplied, they are appended as additive terms (continuous variables
directly, categorical variables as \code{factor()}). When a
\code{slope_shifter} is specified (not \code{"NONE"}), the main
production part is reparameterized as:
\preformatted{
    outcome ~ factor(slope_shifter) * (FXN[[1]]) - (FXN[[1]]) + shifters
    }
}
\item{Inefficiency function (\code{uequ})}{
Built as \code{~ 1 + ...} using continuous and/or categorical variables
specified in \code{ulist}. If neither \code{Svarlist} nor
\code{Fvarlist} are supplied (or all are filtered out), \code{uequ} is
set to \code{NULL}.
}
\item{Risk function (\code{vequ})}{
Built analogously to \code{uequ} using \code{vlist}. If no valid
covariates remain, \code{vequ} is set to \code{NULL}.
}
}

In all three parts, continuous and categorical candidate variables are
screened to avoid near-constant or extremely sparse regressors:
\itemize{
\item Continuous variables are retained only if
\eqn{| sd(x) / mean(x) | > 0.001}.
\item Categorical variables are retained only if they have more than one
level and the smallest category represents at least \code{0.01\%} of the
sample.
}
}
\seealso{
Other frontier analysis: 
\code{\link{fit_organizer}()},
\code{\link{msf_workhorse}()},
\code{\link{sf_functional_forms}()},
\code{\link{sf_model_specifications}()},
\code{\link{sf_workhorse}()},
\code{\link{sfaR_summary}()}
}
\concept{frontier analysis}
